<?xml version="1.0" encoding="UTF-8"?>
<hadolint-rules>
	<rule>
		<key>Hadolint.DL3000</key>
		<name><![CDATA[Use absolute WORKDIR.]]></name>
		<description><![CDATA[
			<h2>Rationale :</h2>
			<p>
				By using absolute paths you will not run into problems when a previous <b>WORKDIR</b> instruction changes.<br/>
				You also often times don't know the <b>WORKDIR</b> context of your base container.
			</p>
			<h2>Problematic code :</h2>
			<pre>FROM busybox
WORKDIR usr/src/app</pre>
			<h2>Correct code :</h2>
			<pre>FROM busybox
WORKDIR /usr/src/app</pre>
			<h2>Exceptions :</h2>
			<p>When using environment replacements.
				<pre>FROM busybox
ENV foo /bar
WORKDIR ${foo}   # WORKDIR /bar</pre>
			</p>]]>
		</description>
		<severity>CRITICAL</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>CODE_SMELL</type>
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
		<remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
	</rule>
	<rule>
		<key>Hadolint.DL3001</key>
		<name><![CDATA[Command does not make sense in a container.]]></name>
		<description><![CDATA[
			<h2>Rationale :</h2>
			<p>
				For some POSIX commands it makes no sense to run them in a Docker container because they are bound to the host or are otherwise dangerous (like ´shutdown´, ´service´, ´ps´, ´free´, ´top´, ´kill´, ´mount´, ´ifconfig´). Interactive utilities also don't make much sense (´nano´, ´vim´).
			</p>
			<h2>Problematic code :</h2>
			<pre>FROM busybox
RUN top</pre>
			<h2>Correct code :</h2>
			<pre>FROM busybox</pre>]]>
		</description>
		<severity>MINOR</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>CODE_SMELL</type>
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
		<remediationFunctionBaseEffort>5min</remediationFunctionBaseEffort>
	</rule>
	<rule>
		<key>Hadolint.DL3002</key>
		<name><![CDATA[Last user should not be root.]]></name>
		<description><![CDATA[
			<h2>Rationale :</h2>
			<p>
				Switching to the root <b>USER</b> opens up certain security risks if an attacker gets access to the container. In order to mitigate this, switch back to a non privileged user after running the commands you need as root.
			</p>
			<h2>Problematic code :</h2>
			<pre>FROM busybox
USER root
RUN ...</pre>
			<h2>Correct code :</h2>
			<pre>FROM busybox
USER root
RUN ...
USER guest</pre>]]>
		</description>
		<severity>CRITICAL</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>CODE_SMELL</type>
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
		<remediationFunctionBaseEffort>5min</remediationFunctionBaseEffort>
	</rule>

</hadolint-rules>